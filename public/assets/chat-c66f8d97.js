import{d as F,H as y,q as H,s as C,o as S,w as z,f as l,c as n,a as r,b as A,g as o,j as e,F as B,J as E,x as _,K as N,e as k,i as x,z as j,A as $,L as h,_ as q}from"./index-9250cf41.js";import{a as J}from"./chat-5c60e301.js";import{b as K,d as b}from"./chat-0b571d6e.js";import{t as w}from"./timeToDate-4f013b84.js";import{s as O}from"./sendMsg-7b8c4cc8.js";import{x as T}from"./chat-b08578f0.js";import"./chat-608f0192.js";const P={class:"chat-content-body"},U={key:0},W=["index"],G={key:0,class:"chat_left"},Q={class:"user-avatr"},X={class:"user-avatr-time"},Y={class:"chat-speak"},Z={class:"chat-speak-01"},ee={class:"dh_action"},se={key:1,class:"chat_right"},te={class:"user-avatr"},oe={class:"user-avatr-time"},ae={class:"chat-speak"},ce=F({__name:"chat",setup(re){const m="preview-only",u=y(),p=y();let I=H(),V=K();const{chatMsgList:i,nowChatId:d}=C(V),{avatar:M}=C(I);function v(){let t=u.value.clientHeight;p.value.setScrollTop(t+500)}S(()=>{v();let t=b.getAllChat();Object.keys(t).length==0&&b.addChat()});const f=t=>`${t}`;let R=t=>{navigator.clipboard.writeText(t).then(()=>{h.success("复制成功")}).catch(a=>{var s=document.createElement("textarea");s.value=t,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),h.success("复制成功")})},L=()=>{h.success("重新发送中");let a=i.value[d.value].msglist;for(let s=0;s<a.length;s++)if(a[a.length-s-1].role=="user"){O(a[a.length-s-1].msg,"refresh");break}};return z(i,(t,a)=>{setTimeout(()=>{v()},100)},{deep:!0}),(t,a)=>{const s=k("el-avatar"),g=k("Icon");return l(),n("div",P,[r(e(N),{ref_key:"scrollbarRef",ref:p,style:{overflow:"hidden"},class:"infinite-list chat-content-scroll",always:""},{default:A(()=>[o("div",{ref_key:"innerRef",ref:u},[e(i)[e(d)]?(l(),n("div",U,[(l(!0),n(B,null,E(e(i)[e(d)].msglist,(c,D)=>(l(),n("div",{index:D,class:"scrollbar-demo-item"},[c.role!="user"?(l(),n("div",G,[o("div",Q,[r(s,{src:e(J)},null,8,["src"]),o("span",X,x(e(w).setTime(c.time)),1)]),o("div",Y,[o("div",Z,[r(e(T),{previewTheme:"vuepress",formatCopiedText:f,editorId:m,modelValue:c.msg},null,8,["modelValue"]),j(o("div",ee,[r(g,{name:"el-icon-CopyDocument",onClick:le=>e(R)(c.msg),title:"复制",color:"#8595F4",size:"20"},null,8,["onClick"]),r(g,{name:"el-icon-Refresh",onClick:e(L),title:"重试",color:"#8595F4",size:"20"},null,8,["onClick"])],512),[[$,c.isfinish]])])])])):_("",!0),c.role=="user"?(l(),n("div",se,[o("div",te,[r(s,{src:e(M)},null,8,["src"]),o("span",oe,x(e(w).setTime(c.time)),1)]),o("div",ae,[r(e(T),{previewTheme:"vuepress",formatCopiedText:f,editorId:m,modelValue:c.msg},null,8,["modelValue"])])])):_("",!0)],8,W))),256))])):_("",!0)],512)]),_:1},512)])}}});const pe=q(ce,[["__scopeId","data-v-45f707cd"]]);export{pe as default};
