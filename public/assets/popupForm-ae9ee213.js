import{defineComponent as L,ref as C,inject as P,reactive as x,watch as T,resolveComponent as i,resolveDirective as p,openBlock as c,createBlock as f,unref as e,withCtx as a,withDirectives as g,createElementBlock as U,createTextVNode as h,toDisplayString as y,createElementVNode as K,normalizeStyle as R,createVNode as m,normalizeClass as W,withKeys as $}from"vue";import{useI18n as q}from"vue-i18n";import{c as A,i as w,_ as H}from"./index-89e26330.js";import{h as J}from"./controllerUrls-941681c3.js";import{F as M}from"./index-39d73c69.js";import{b as O}from"./validate-e09b6b50.js";import"vue-router";import"pinia";import"vue-demi";import"element-plus";import"./index-0a827c2c.js";import"./index-d3b20950.js";function Q(){return A({url:J+"index",method:"get"})}const X={class:"title"},Y=L({__name:"popupForm",setup(Z,{expose:V}){const _=C(),b=C(),t=P("baTable"),{t:l}=q(),r=x({treeKey:w(),defaultCheckedKeys:[],menuRules:[]}),F=x({name:[O({name:"required",title:l("user.group.Group name")})],auth:[{required:!0,validator:(s,o,n)=>v().length<=0?n(new Error(l("Please select field",{field:l("user.group.jurisdiction")}))):n()}]});Q().then(s=>{r.menuRules=s.data.list});const v=()=>_.value.getCheckedKeys().concat(_.value.getHalfCheckedKeys()),N=(s,o)=>{if(o.isLeaf)return"";let n=!0;for(const u in o.childNodes)o.childNodes[u].isLeaf||(n=!1);return n?"penultimate-node":""};return V({getCheckeds:v}),T(()=>t.form.items.rules,()=>{if(t.form.items.rules&&t.form.items.rules.length)if(t.form.items.rules.includes("*")){let s=[];for(const o in r.menuRules)s.push(r.menuRules[o].id);r.defaultCheckedKeys=s}else r.defaultCheckedKeys=t.form.items.rules;else r.defaultCheckedKeys=[];r.treeKey=w()}),(s,o)=>{const n=i("el-input"),u=i("el-form-item"),S=i("el-tree"),D=i("el-form"),I=i("el-scrollbar"),k=i("el-button"),z=i("el-dialog"),E=p("drag"),j=p("zoom"),B=p("loading"),G=p("blur");return c(),f(z,{class:"ba-operate-dialog",top:"10vh","close-on-click-modal":!1,"model-value":!!e(t).form.operate,onClose:e(t).toggleForm,"destroy-on-close":!0},{header:a(()=>[g((c(),U("div",X,[h(y(e(t).form.operate?e(l)(e(t).form.operate):""),1)])),[[E,[".ba-operate-dialog",".el-dialog__header"]],[j,".ba-operate-dialog"]])]),footer:a(()=>[K("div",{style:R("width: calc(100% - "+e(t).form.labelWidth/1.8+"px)")},[m(k,{onClick:o[3]||(o[3]=d=>e(t).toggleForm(""))},{default:a(()=>[h(y(e(l)("Cancel")),1)]),_:1}),g((c(),f(k,{loading:e(t).form.submitLoading,onClick:o[4]||(o[4]=d=>e(t).onSubmit(b.value)),type:"primary"},{default:a(()=>[h(y(e(t).form.operateIds&&e(t).form.operateIds.length>1?e(l)("Save and edit next item"):e(l)("Save")),1)]),_:1},8,["loading"])),[[G]])],4)]),default:a(()=>[g((c(),f(I,{class:"ba-table-form-scrollbar"},{default:a(()=>[K("div",{class:W(["ba-operate-form","ba-"+e(t).form.operate+"-form"]),style:R("width: calc(100% - "+e(t).form.labelWidth/2+"px)")},[m(D,{ref_key:"formRef",ref:b,onKeyup:o[2]||(o[2]=$(d=>e(t).onSubmit(b.value),["enter"])),model:e(t).form.items,"label-position":"right","label-width":e(t).form.labelWidth+"px",rules:F},{default:a(()=>[m(u,{prop:"name",label:e(l)("user.group.Group name")},{default:a(()=>[m(n,{modelValue:e(t).form.items.name,"onUpdate:modelValue":o[0]||(o[0]=d=>e(t).form.items.name=d),type:"string",placeholder:e(l)("Please input field",{field:e(l)("user.group.Group name")})},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),m(u,{prop:"auth",label:e(l)("user.group.jurisdiction")},{default:a(()=>[(c(),f(S,{ref_key:"treeRef",ref:_,key:r.treeKey,"default-checked-keys":r.defaultCheckedKeys,"default-expand-all":!0,"show-checkbox":"","node-key":"id",props:{children:"children",label:"title",class:N},data:r.menuRules},null,8,["default-checked-keys","props","data"]))]),_:1},8,["label"]),m(M,{label:e(l)("state"),modelValue:e(t).form.items.status,"onUpdate:modelValue":o[1]||(o[1]=d=>e(t).form.items.status=d),type:"radio",data:{content:{0:e(l)("Disable"),1:e(l)("Enable")},childrenAttr:{border:!0}}},null,8,["label","modelValue","data"])]),_:1},8,["model","label-width","rules"])],6)]),_:1})),[[B,e(t).form.loading]])]),_:1},8,["model-value","onClose"])}}});const ce=H(Y,[["__scopeId","data-v-72027edc"]]);export{ce as default};
