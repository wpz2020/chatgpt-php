import{l as B,d as E,$ as I,r as G,f as d,c,a as n,b as i,j as t,N as S,z as p,Y as h,h as x,i as A,aL as N,F as O,J as P,x as U,e as f,aC as q,_ as T}from"./index-9250cf41.js";import{F as m}from"./index-5cf5ba2e.js";import"./index-47490f62.js";import"./controllerUrls-941681c3.js";import"./index-bb9265a5.js";function L(g){return B({url:"/admin/sms.Config/getConfigKey",method:"get",params:{name:g}})}function M(g,a,u=""){return B({url:"/admin/sms.Config/saveConfig",method:"post",params:{type:g,name:u},data:a},{showSuccessMessage:!0})}const j={class:"default-main"},z=E({__name:"config",setup(g){const{t:a,te:u}=I(),e=G({collapseActiveName:["base","gateway"],base:{loading:!1,timeout:0,strategy:"",gateways:[]},gateway:{name:"",loading:!1,submitLoading:!1},gatewayConfig:{}}),y=()=>{e.base.loading=!0,M("base",e.base).finally(()=>{e.base.loading=!1})},b=()=>{e.gateway.submitLoading=!0,M("gateway",e.gatewayConfig,e.gateway.name).finally(()=>{e.gateway.submitLoading=!1})},K=()=>{e.gateway.loading=!0,L(e.gateway.name).then(r=>{e.gatewayConfig=r.data.config}).finally(()=>{e.gateway.loading=!1})},w={aliyun:a("sms.config.aliyun"),qcloud:a("sms.config.qcloud"),qiniu:a("sms.config.qiniu"),yunpian:a("sms.config.yunpian")};return(()=>{e.base.loading=!0,L("base").then(r=>{e.base.timeout=r.data.timeout,e.base.gateways=r.data.gateways,e.base.strategy=r.data.strategy=="Overtrue\\EasySms\\Strategies\\OrderStrategy"?"order":"random"}).finally(()=>{e.base.loading=!1})})(),(r,o)=>{const v=f("el-button"),_=f("el-form"),C=f("el-collapse-item"),$=f("el-collapse"),V=q("blur"),F=q("loading");return d(),c("div",j,[n($,{class:"collapse",modelValue:e.collapseActiveName,"onUpdate:modelValue":o[8]||(o[8]=l=>e.collapseActiveName=l)},{default:i(()=>[n(C,{class:"collapse-item",title:t(a)("sms.config.Basic SMS configuration"),name:"base"},{default:i(()=>[n(_,{onKeyup:o[4]||(o[4]=S(l=>y(),["enter"])),model:e.base,"label-position":"top","label-width":200},{default:i(()=>[n(m,{type:"number",label:t(a)("sms.config.Send timeout (seconds)"),modelValue:e.base.timeout,"onUpdate:modelValue":o[0]||(o[0]=l=>e.base.timeout=l),modelModifiers:{number:!0}},null,8,["label","modelValue"]),n(m,{type:"radio",label:t(a)("sms.config.Send Policy"),modelValue:e.base.strategy,"onUpdate:modelValue":o[1]||(o[1]=l=>e.base.strategy=l),modelModifiers:{number:!0},data:{content:{order:t(a)("sms.config.Sequential service provider sends"),random:t(a)("sms.config.Sent with the service provider")},childrenAttr:{border:!0}}},null,8,["label","modelValue","data"]),n(m,{type:"selects",label:t(a)("sms.config.Available service providers"),modelValue:e.base.gateways,"onUpdate:modelValue":o[2]||(o[2]=l=>e.base.gateways=l),modelModifiers:{number:!0},placeholder:t(a)("sms.config.The selected service provider needs to configure information at the bottom of this page (required)"),data:{content:w,childrenAttr:{border:!0}}},null,8,["label","modelValue","placeholder","data"]),p((d(),h(v,{loading:e.base.loading,onClick:o[3]||(o[3]=l=>y()),type:"primary"},{default:i(()=>[x(A(t(a)("Save")),1)]),_:1},8,["loading"])),[[V]])]),_:1},8,["model"])]),_:1},8,["title"]),n(C,{class:"collapse-item",title:t(a)("sms.config.Service Provider Configuration"),name:"gateway"},{default:i(()=>[n(_,{onKeyup:o[7]||(o[7]=S(l=>b(),["enter"])),model:e.gatewayConfig,"label-position":"top","label-width":200},{default:i(()=>[n(m,{type:"select",label:t(a)("sms.config.Service provider"),modelValue:e.gateway.name,"onUpdate:modelValue":o[5]||(o[5]=l=>e.gateway.name=l),modelModifiers:{number:!0},placeholder:t(a)("sms.config.Select a service provider to start configuration"),data:{content:w,childrenAttr:{border:!0}},"input-attr":{onChange:K}},null,8,["label","modelValue","placeholder","data","input-attr"]),p((d(),c("div",null,[!t(N)(e.gatewayConfig)&&!e.gateway.loading?(d(!0),c(O,{key:0},P(e.gatewayConfig,(l,s)=>(d(),c("div",{key:s},[n(m,{type:"string",label:t(u)("sms.config."+e.gateway.name+"/"+s)?t(a)("sms.config."+e.gateway.name+"/"+s):t(a)("sms.config.common/"+s),modelValue:e.gatewayConfig[s],"onUpdate:modelValue":D=>e.gatewayConfig[s]=D,placeholder:t(u)("sms.config."+e.gateway.name+"/placeholder/"+s)?t(a)("sms.config."+e.gateway.name+"/placeholder/"+s):""},null,8,["label","modelValue","onUpdate:modelValue","placeholder"])]))),128)):U("",!0)])),[[F,e.gateway.loading]]),t(N)(e.gatewayConfig)?U("",!0):p((d(),h(v,{key:0,loading:e.gateway.submitLoading,onClick:o[6]||(o[6]=l=>b()),type:"primary"},{default:i(()=>[x(A(t(a)("Save")),1)]),_:1},8,["loading"])),[[V]])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["modelValue"])])}}});const W=T(z,[["__scopeId","data-v-bafe28a2"]]);export{W as default};
