import{defineComponent as Ne,ref as me,reactive as ue,onMounted as Re,nextTick as fe,resolveComponent as P,resolveDirective as pe,openBlock as s,createElementBlock as b,createElementVNode as f,createVNode as n,withCtx as u,unref as r,withDirectives as L,createBlock as y,createTextVNode as C,toDisplayString as h,Transition as Ae,Fragment as V,renderList as k,createCommentVNode as U,normalizeClass as be,withModifiers as j,withKeys as Ke,normalizeStyle as ye,pushScopeId as $e,popScopeId as Ge}from"vue";import{f as Be,S as ge,e as A,B as Fe}from"./index-0a827c2c.js";import{F as p}from"./index-39d73c69.js";import{f as K,d as ve,t as I,g as Ee,a as X,b as qe,c as Oe,e as he,h as je,s as D,p as ze,i as Me}from"./crud-ccf00dde.js";import{P as ee,X as He,R as Je,D as We,al as Y,O as $,aD as Se,_ as Xe}from"./index-89e26330.js";import{ElNotification as Q,ElMessageBox as Ye}from"element-plus";import{b as G,a as Qe}from"./validate-e09b6b50.js";import{useRouter as Ze}from"vue-router";import{useI18n as el}from"vue-i18n";import{i as ll}from"./isSymbol-5418c187.js";import"./controllerUrls-941681c3.js";import"./index-d3b20950.js";import"pinia";import"vue-demi";var tl=/\s/;function al(d){for(var t=d.length;t--&&tl.test(d.charAt(t)););return t}var ol=/^\s+/;function rl(d){return d&&d.slice(0,al(d)+1).replace(ol,"")}var Ve=0/0,il=/^[-+]0x[0-9a-f]+$/i,dl=/^0b[01]+$/i,nl=/^0o[0-7]+$/i,sl=parseInt;function cl(d){if(typeof d=="number")return d;if(ll(d))return Ve;if(ee(d)){var t=typeof d.valueOf=="function"?d.valueOf():d;d=ee(t)?t+"":t}if(typeof d!="string")return d===0?d:+d;d=rl(d);var g=dl.test(d);return g||nl.test(d)?sl(d.slice(2),g?2:8):il.test(d)?Ve:+d}var we=1/0,ml=17976931348623157e292;function Z(d){if(!d)return d===0?d:0;if(d=cl(d),d===we||d===-we){var t=d<0?-1:1;return t*ml}return d===d?d:0}function ul(d,t,g){if(!ee(g))return!1;var S=typeof t;return(S=="number"?He(g)&&Be(t,g.length):S=="string"&&t in g)?Je(g[t],d):!1}var fl=Math.ceil,pl=Math.max;function bl(d,t,g,S){for(var N=-1,T=pl(fl((t-d)/(g||1)),0),R=Array(T);T--;)R[S?T:++N]=d,d+=g;return R}function yl(d){return function(t,g,S){return S&&typeof S!="number"&&ul(t,g,S)&&(g=S=void 0),t=Z(t),g===void 0?(g=t,t=0):g=Z(g),S=S===void 0?t<g?1:-1:Z(S),bl(t,g,S,d)}}var gl=yl();const Pe=gl,Fl=d=>($e("data-v-9df8a32c"),d=d(),Ge(),d),vl={class:"default-main"},hl={class:"header-config-box"},Sl={class:"header"},Vl={class:"header-item-box"},wl={class:"header-right"},Pl={key:0,class:"header-senior-config-box"},kl={class:"header-senior-config-form"},_l={class:"default-sort-field-box"},Cl=["onClick","data-id"],Dl={class:"design-field"},Ll={class:"design-field"},Tl={class:"design-field-right"},Ul={key:0,class:"design-field-empty"},Il={class:"field-config ba-scroll-style"},xl={key:0,class:"design-field-empty"},Nl={class:"field-inline"},Rl={class:"field-inline"},Al={class:"field-inline"},Kl={class:"confirm-generate-dialog-body"},$l=Fl(()=>f("br",null,null,-1)),Gl={class:"confirm-generate-dialog-footer"},Bl=Ne({__name:"design",setup(d){const{t}=el(),g=Ze(),S=me(),N=me(),T=We();let R=1;const e=ue({loading:{init:!1,generate:!1,remoteSelect:!1},table:{name:"",comment:"",quickSearchField:[],defaultSortField:"",formFields:[],columnFields:[],defaultSortType:"desc",modelFile:"",controllerFile:"",validateFile:"",webViewsDir:""},fields:[],activateField:-1,fieldCollapseName:["common","base","senior"],remoteSelectPre:{show:!1,index:-1,dbList:[],fieldList:[],modelFileList:[],controllerFileList:[],loading:!1,hideDelField:!1,form:{table:"",pk:"",label:"",joinField:[],modelFile:"",controllerFile:""}},showHeaderSeniorConfig:!1,confirmGenerate:{show:!1,table:!1,controller:!1}}),ke=o=>{e.activateField=o},_e=()=>{const o=A(e.fields[e.activateField]);for(const l in o.table)o.table[l]=o.table[l].value;for(const l in o.form)o.form[l]=o.form[l].value;e.fields[e.activateField]=B(o)},le=o=>{for(const l in I)for(const i in e.table[I[l]])Y(e.fields,"name",e.table[I[l]][i])||(e.table[I[l]][i]=o);e.table.defaultSortField&&(Y(e.fields,"name",e.table.defaultSortField)||(e.table.defaultSortField=o))},te=o=>{if(e.fields[o]){e.activateField=-1,e.fields[o].name==e.table.defaultSortField&&(e.table.defaultSortField="");for(const l in I){const i=e.table[I[l]].findIndex(m=>m==e.fields[o].name);i!=-1&&e.table[I[l]].splice(i,1)}e.fields.splice(o,1)}},ae=(o,l=!1)=>{e.remoteSelectPre.show=!0,e.remoteSelectPre.loading=!0,e.remoteSelectPre.index=o,e.remoteSelectPre.hideDelField=l,Ee().then(i=>{e.remoteSelectPre.dbList=i.data.dbs,e.fields[o]&&e.fields[o].form["remote-table"].value&&(e.remoteSelectPre.form.table=e.fields[o].form["remote-table"].value,e.remoteSelectPre.form.pk=e.fields[o].form["remote-pk"].value,e.remoteSelectPre.form.label=e.fields[o].form["remote-field"].value,e.remoteSelectPre.form.controllerFile=e.fields[o].form["remote-controller"].value,e.remoteSelectPre.form.modelFile=e.fields[o].form["remote-model"].value,e.remoteSelectPre.form.joinField=e.fields[o].form["relation-fields"].value.split(","),$(e.remoteSelectPre.fieldList)&&Se(e.fields[o].form["remote-table"].value).then(m=>{const v={};for(const w in m.data.fieldList)v[w]=(w?w+" - ":"")+m.data.fieldList[w];e.remoteSelectPre.fieldList=v}),($(e.remoteSelectPre.modelFileList)||$(e.remoteSelectPre.controllerFileList))&&X(e.fields[o].form["remote-table"].value).then(m=>{e.remoteSelectPre.modelFileList=m.data.modelFileList,e.remoteSelectPre.controllerFileList=m.data.controllerFileList}))}).finally(()=>{e.remoteSelectPre.loading=!1})},Ce=(o,l)=>{if(["remoteSelect","remoteSelects"].includes(l.designType))return ae(o)},z=()=>{e.confirmGenerate.show=!1},oe=()=>{e.loading.generate=!0;const o=A(e.fields);for(const l in o){for(const i in o[l].table)o[l].table[i]=o[l].table[i].value;for(const i in o[l].form)o[l].form[i]=o[l].form[i].value}qe({table:e.table,fields:o}).then(()=>{g.go(0)}).finally(()=>{e.loading.generate=!1,z()})},De=()=>{let o="";if(e.fields.find(i=>{if(!Qe(i.name))return o=t("crud.crud.Field name is invalid It starts with a letter or underscore and cannot contain any character other than letters, digits, or underscores",{field:i.name}),!0}),e.fields.findIndex(i=>i.primaryKey)===-1&&(o=t("crud.crud.Please design the primary key field!")),e.table.name||(o=t("crud.crud.Please enter the data table name!")),o){Q({type:"error",message:o});return}e.loading.generate=!0,Oe({table:e.table.name,controllerFile:e.table.controllerFile}).then(()=>{oe()}).catch(i=>{e.loading.generate=!1,i.code==-1?(e.confirmGenerate.show=!0,e.confirmGenerate.table=i.data.table,e.confirmGenerate.controller=i.data.controller):Q({type:"error",message:i.msg})})},Le=()=>{if(!e.table.name&&!e.table.comment&&!e.fields.length)return he("start");Ye.confirm(t("crud.crud.It is irreversible to give up the design Are you sure you want to give up?"),t("Reminder"),{confirmButtonText:t("crud.crud.give up"),cancelButtonText:t("Cancel"),type:"warning"}).then(()=>{he("start")}).catch(()=>{})},B=o=>{const l=A(ve[o.designType]);for(const i in o.form)l.form[i]&&(l.form[i].value=o.form[i]),i=="image-multi"&&o.form[i]&&(l.table.render=je("render","images"));for(const i in o.table)l.table[i]&&(l.table[i].value=o.table[i]);return o.form=l.form,o.table=l.table,o},Te=o=>{if(["enum","set"].includes(e.fields[e.activateField].type)){if(!o){e.fields[e.activateField].dataType=`${e.fields[e.activateField].type}()`;return}o=o.replaceAll("：",":"),o=o.replaceAll("，",",");let l=o.split(":");l[1]&&(l=l[1].split(","),l=l.map(i=>{if(!i)return"";let m=i.split("=");return m[0]&&m[1]?`'${m[0]}'`:""}).filter(i=>i!=""),e.fields[e.activateField].dataType=`${e.fields[e.activateField].type}(${l.join(",")})`)}},Ue=()=>{if(["db","sql","log"].includes(D.type)){if(e.loading.init=!0,D.type=="log"){ze(parseInt(D.startData.logId)).then(o=>{e.table=o.data.table;const l=o.data.fields;for(const i in l){const m=B(A(l[i]));e.fields.push(m)}}).finally(()=>{e.loading.init=!1});return}Me(D.type,D.startData.db,D.startData.sql).then(o=>{let l=[];for(const i in o.data.columns){const m=B(o.data.columns[i]);["id","update_time","create_time","updatetime","createtime"].includes(m.name)||e.table.formFields.push(m.name),["textarea","file","files","editor","password","array"].includes(m.designType)||e.table.columnFields.push(m.name),m.designType=="pk"&&(e.table.defaultSortField=m.name,e.table.quickSearchField.push(m.name)),m.designType=="weigh"&&(e.table.defaultSortField=m.name),l.push(m)}e.fields=l,e.table.comment=o.data.comment,D.type=="db"&&D.startData.db&&(e.table.name=D.startData.db,re(D.startData.db))}).finally(()=>{e.loading.init=!1})}};Re(()=>{Ue();const o=ge.create(S.value,{group:"design-field",animation:200,filter:".design-field-empty",onAdd:l=>{var v,w;const i=(w=(v=l.originalEvent)==null?void 0:v.dataTransfer)==null?void 0:w.getData("name"),m=K[i];if(m&&m[l.oldIndex]){const F=B(A(m[l.oldIndex]));if(F.primaryKey==!0){if(e.fields.find(H=>H.primaryKey))return Q({type:"error",message:t("crud.crud.There can only be one primary key field")}),l.item.remove();e.table.defaultSortField=F.name,e.table.quickSearchField.push(F.name)}F.designType=="weigh"&&(e.table.defaultSortField=F.name),Y(e.fields,"name",F.name)&&(F.name=F.name+R,R++),e.fields.splice(l.newIndex,0,F),["remoteSelect","remoteSelects"].includes(F.designType)&&ae(l.newIndex,!0),F.formBuildExclude||e.table.formFields.push(F.name),F.tableBuildExclude||e.table.columnFields.push(F.name)}l.item.remove(),fe(()=>{o.sort(Pe(e.fields.length).map(F=>F.toString()))})},onEnd:l=>{const i=e.fields[l.oldIndex];e.fields.splice(l.oldIndex,1),e.fields.splice(l.newIndex,0,i),fe(()=>{o.sort(Pe(e.fields.length).map(m=>m.toString()))})}});T.value.forEach((l,i)=>{ge.create(l,{sort:!1,group:{name:"design-field",pull:"clone",put:!1},animation:200,setData:m=>{m.setData("name",Object.keys(K)[i])}})})});const re=o=>{o&&X(o).then(l=>{e.table.modelFile=l.data.modelFile,e.table.controllerFile=l.data.controllerFile,e.table.validateFile=l.data.validateFile,e.table.webViewsDir=l.data.webViewsDir})},Ie=o=>{o&&(M(),e.remoteSelectPre.form.table=o,e.loading.remoteSelect=!0,Se(o).then(l=>{e.remoteSelectPre.form.pk=l.data.pk;const i=["name","title","username","nickname"];for(const v in l.data.fieldList)if(i.includes(v)){e.remoteSelectPre.form.label=v,e.remoteSelectPre.form.joinField.push(v);break}const m={};for(const v in l.data.fieldList)m[v]=(v?v+" - ":"")+l.data.fieldList[v];e.remoteSelectPre.fieldList=m}).finally(()=>{e.loading.remoteSelect=!1}),X(o).then(l=>{e.remoteSelectPre.modelFileList=l.data.modelFileList,e.remoteSelectPre.controllerFileList=l.data.controllerFileList,Object.keys(l.data.modelFileList).includes(l.data.modelFile)&&(e.remoteSelectPre.form.modelFile=l.data.modelFile),Object.keys(l.data.controllerFileList).includes(l.data.controllerFile)&&(e.remoteSelectPre.form.controllerFile=l.data.controllerFile)}))},ie=()=>{const o=()=>{e.fields[e.remoteSelectPre.index].form["remote-table"].value=e.remoteSelectPre.form.table,e.fields[e.remoteSelectPre.index].form["remote-pk"].value=e.remoteSelectPre.form.pk,e.fields[e.remoteSelectPre.index].form["remote-field"].value=e.remoteSelectPre.form.label,e.fields[e.remoteSelectPre.index].form["remote-controller"].value=e.remoteSelectPre.form.controllerFile,e.fields[e.remoteSelectPre.index].form["remote-model"].value=e.remoteSelectPre.form.modelFile,e.fields[e.remoteSelectPre.index].form["relation-fields"].value=e.remoteSelectPre.form.joinField.join(","),e.remoteSelectPre.index=-1,e.remoteSelectPre.show=!1,M()};N.value&&N.value.validate(l=>{l&&o()})},de=()=>{e.remoteSelectPre.show=!1,M(),e.remoteSelectPre.index!==-1&&e.remoteSelectPre.hideDelField&&te(e.remoteSelectPre.index)},M=()=>{for(const o in e.remoteSelectPre.form)o=="joinField"?e.remoteSelectPre.form[o]=[]:e.remoteSelectPre.form[o]=""},xe=ue({table:[G({name:"required",title:t("crud.crud.remote-table")})],pk:[G({name:"required",title:t("crud.crud.Drop down value field")})],label:[G({name:"required",title:t("crud.crud.Drop down label field")})],joinField:[G({name:"required",title:t("crud.crud.Fields displayed in the table")})],controllerFile:[G({name:"required",title:t("crud.crud.Controller position")})]});return(o,l)=>{const i=P("el-button"),m=P("el-row"),v=P("el-option"),w=P("el-select"),F=P("el-form-item"),E=P("Icon"),q=P("el-collapse-item"),H=P("el-collapse"),J=P("el-col"),O=P("el-divider"),ne=P("el-form"),se=P("el-dialog"),ce=P("el-alert"),x=pe("blur"),W=pe("loading");return s(),b("div",vl,[f("div",hl,[n(m,{class:"header-box"},{default:u(()=>[f("div",Sl,[f("div",Vl,[n(p,{class:"mr-20 table-name-item",label:r(t)("crud.log.table_name"),modelValue:e.table.name,"onUpdate:modelValue":l[0]||(l[0]=a=>e.table.name=a),type:"string",placeholder:r(t)("crud.crud.Name of the data table"),"input-attr":{onChange:re}},null,8,["label","modelValue","placeholder","input-attr"]),n(p,{class:"table-comment-item",label:r(t)("crud.crud.Data Table Notes"),modelValue:e.table.comment,"onUpdate:modelValue":l[1]||(l[1]=a=>e.table.comment=a),type:"string",placeholder:r(t)("crud.crud.For example: `user table` will be generated into `user management`")},null,8,["label","modelValue","placeholder"])]),f("div",wl,[L((s(),y(i,{type:"primary",loading:e.loading.generate,onClick:De},{default:u(()=>[C(h(r(t)("crud.crud.Generate CRUD code")),1)]),_:1},8,["loading"])),[[x]]),L((s(),y(i,{onClick:Le,type:"danger"},{default:u(()=>[C(h(r(t)("crud.crud.give up")),1)]),_:1})),[[x]])])])]),_:1}),n(Ae,{name:e.showHeaderSeniorConfig?"el-zoom-in-top":"el-zoom-in-bottom"},{default:u(()=>[e.showHeaderSeniorConfig?(s(),b("div",Pl,[f("div",kl,[n(F,{"label-width":140,label:r(t)("crud.crud.Table Quick Search Fields")},{default:u(()=>[n(w,{clearable:!0,multiple:!0,class:"w100",modelValue:e.table.quickSearchField,"onUpdate:modelValue":l[2]||(l[2]=a=>e.table.quickSearchField=a),placement:"bottom"},{default:u(()=>[(s(!0),b(V,null,k(e.fields,(a,c)=>(s(),y(v,{key:c,label:a.name+(a.title?"-"+a.title:""),value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),f("div",_l,[n(F,{"label-width":140,class:"default-sort-field",label:r(t)("crud.crud.Table Default Sort Fields")},{default:u(()=>[n(w,{clearable:!0,modelValue:e.table.defaultSortField,"onUpdate:modelValue":l[3]||(l[3]=a=>e.table.defaultSortField=a),placement:"bottom"},{default:u(()=>[(s(!0),b(V,null,k(e.fields,(a,c)=>(s(),y(v,{key:c,label:a.name+(a.title?"-"+a.title:""),value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(p,{class:"default-sort-field-type",label:r(t)("crud.crud.sort order"),modelValue:e.table.defaultSortType,"onUpdate:modelValue":l[4]||(l[4]=a=>e.table.defaultSortType=a),type:"select",data:{content:{desc:r(t)("crud.crud.sort order desc"),asc:r(t)("crud.crud.sort order asc")}}},null,8,["label","modelValue","data"])]),n(F,{"label-width":140,label:r(t)("crud.crud.Fields as Table Columns")},{default:u(()=>[n(w,{clearable:!0,multiple:!0,class:"w100",modelValue:e.table.columnFields,"onUpdate:modelValue":l[5]||(l[5]=a=>e.table.columnFields=a),placement:"bottom"},{default:u(()=>[(s(!0),b(V,null,k(e.fields,(a,c)=>(s(),y(v,{key:c,label:a.name+(a.title?"-"+a.title:""),value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(F,{"label-width":140,label:r(t)("crud.crud.Fields as form items")},{default:u(()=>[n(w,{clearable:!0,multiple:!0,class:"w100",modelValue:e.table.formFields,"onUpdate:modelValue":l[6]||(l[6]=a=>e.table.formFields=a),placement:"bottom"},{default:u(()=>[(s(!0),b(V,null,k(e.fields,(a,c)=>(s(),y(v,{key:c,label:a.name+(a.title?"-"+a.title:""),value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(p,{label:r(t)("crud.crud.Generated Controller Location"),modelValue:e.table.controllerFile,"onUpdate:modelValue":l[7]||(l[7]=a=>e.table.controllerFile=a),type:"string",attr:{"label-width":140}},null,8,["label","modelValue"]),n(p,{label:r(t)("crud.crud.Generated Data Model Location"),modelValue:e.table.modelFile,"onUpdate:modelValue":l[8]||(l[8]=a=>e.table.modelFile=a),type:"string",attr:{"label-width":140}},null,8,["label","modelValue"]),n(p,{label:r(t)("crud.crud.Generated Validator Location"),modelValue:e.table.validateFile,"onUpdate:modelValue":l[9]||(l[9]=a=>e.table.validateFile=a),type:"string",attr:{"label-width":140}},null,8,["label","modelValue"]),n(p,{label:r(t)("crud.crud.WEB end view directory"),modelValue:e.table.webViewsDir,"onUpdate:modelValue":l[10]||(l[10]=a=>e.table.webViewsDir=a),type:"string",attr:{"label-width":140}},null,8,["label","modelValue"])])])):U("",!0)]),_:1},8,["name"]),f("div",{onClick:l[11]||(l[11]=a=>e.showHeaderSeniorConfig=!e.showHeaderSeniorConfig),class:"header-senior-config"},[f("span",null,h(r(t)("crud.crud.Advanced Configuration")),1),n(E,{class:"senior-config-arrow-icon",size:"14",color:"var(--el-color-info)",name:e.showHeaderSeniorConfig?"el-icon-ArrowUp":"el-icon-ArrowDown"},null,8,["name"])])]),L((s(),y(m,{class:"fields-box",gutter:20},{default:u(()=>[n(J,{xs:24,span:6},{default:u(()=>[n(H,{class:"field-collapse",modelValue:e.fieldCollapseName,"onUpdate:modelValue":l[12]||(l[12]=a=>e.fieldCollapseName=a)},{default:u(()=>[n(q,{title:r(t)("crud.crud.Common Fields"),name:"common"},{default:u(()=>[f("div",{class:"field-box",ref:r(T).set},[(s(!0),b(V,null,k(r(K).common,(a,c)=>(s(),b("div",{key:c,class:"field-item"},[f("span",null,h(a.title),1)]))),128))],512)]),_:1},8,["title"]),n(q,{title:r(t)("crud.crud.Base Fields"),name:"base"},{default:u(()=>[f("div",{class:"field-box",ref:r(T).set},[(s(!0),b(V,null,k(r(K).base,(a,c)=>(s(),b("div",{key:c,class:"field-item"},[f("span",null,h(a.title),1)]))),128))],512)]),_:1},8,["title"]),n(q,{title:r(t)("crud.crud.Advanced Fields"),name:"senior"},{default:u(()=>[f("div",{class:"field-box",ref:r(T).set},[(s(!0),b(V,null,k(r(K).senior,(a,c)=>(s(),b("div",{key:c,class:"field-item"},[f("span",null,h(a.title),1)]))),128))],512)]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),n(J,{xs:24,span:12},{default:u(()=>[f("div",{ref_key:"designWindowRef",ref:S,class:be(["design-window ba-scroll-style",e.fields.length?"":"design-window-empty"])},[(s(!0),b(V,null,k(e.fields,(a,c)=>(s(),b("div",{key:c,class:be([c===e.activateField?"activate":"","design-field-box"]),onClick:_=>ke(c),"data-id":c},[f("div",Dl,[f("span",null,h(r(t)("crud.crud.Field Name"))+"：",1),n(Fe,{onPointerdown:l[13]||(l[13]=j(()=>{},["stop"])),class:"design-field-name-input",modelValue:a.name,"onUpdate:modelValue":_=>a.name=_,type:"string",attr:{size:"small",onChange:le}},null,8,["modelValue","onUpdate:modelValue","attr"])]),f("div",Ll,[f("span",null,h(r(t)("crud.crud.field comment"))+"：",1),n(Fe,{onPointerdown:l[14]||(l[14]=j(()=>{},["stop"])),class:"design-field-name-comment",modelValue:a.comment,"onUpdate:modelValue":_=>a.comment=_,type:"string",attr:{size:"small"}},null,8,["modelValue","onUpdate:modelValue"])]),f("div",Tl,[["remoteSelect","remoteSelects"].includes(a.designType)?L((s(),y(i,{key:0,onClick:j(_=>Ce(c,a),["stop"]),type:"primary",size:"small",circle:""},{default:u(()=>[n(E,{color:"var(--el-color-white)",size:"15",name:"fa fa-pencil icon"})]),_:2},1032,["onClick"])),[[x]]):U("",!0),L((s(),y(i,{onClick:j(_=>te(c),["stop"]),type:"danger",size:"small",circle:""},{default:u(()=>[n(E,{color:"var(--el-color-white)",size:"15",name:"fa fa-trash"})]),_:2},1032,["onClick"])),[[x]])])],10,Cl))),128)),e.fields.length?U("",!0):(s(),b("div",Ul,h(r(t)("crud.crud.Drag the left element here to start designing CRUD")),1))],2)]),_:1}),n(J,{xs:24,span:6},{default:u(()=>[f("div",Il,[e.activateField===-1?(s(),b("div",xl,h(r(t)("crud.crud.Please select a field from the left first")),1)):(s(),b("div",{key:"activate-field-"+e.activateField},[n(ne,{"label-position":"top"},{default:u(()=>[n(O,{"content-position":"left"},{default:u(()=>[C(h(r(t)("crud.crud.Common")),1)]),_:1}),n(F,{label:r(t)("crud.crud.generate")},{default:u(()=>[n(w,{onChange:_e,class:"w100",modelValue:e.fields[e.activateField].designType,"onUpdate:modelValue":l[15]||(l[15]=a=>e.fields[e.activateField].designType=a),placement:"bottom"},{default:u(()=>[(s(!0),b(V,null,k(r(ve),(a,c)=>(s(),y(v,{key:c,label:a.name,value:c},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(p,{label:r(t)("crud.crud.Field comments (CRUD dictionary)"),type:"textarea","input-attr":{rows:2,onChange:Te},placeholder:r(t)("crud.crud.The field comment will be used as the CRUD dictionary, and will be identified as the field title before the colon, and as the data dictionary after the colon"),modelValue:e.fields[e.activateField].comment,"onUpdate:modelValue":l[16]||(l[16]=a=>e.fields[e.activateField].comment=a)},null,8,["label","input-attr","placeholder","modelValue"]),n(O,{"content-position":"left"},{default:u(()=>[C(h(r(t)("crud.crud.Field Properties")),1)]),_:1}),n(p,{label:r(t)("crud.crud.Field Name"),type:"string",modelValue:e.fields[e.activateField].name,"onUpdate:modelValue":l[17]||(l[17]=a=>e.fields[e.activateField].name=a),"input-attr":{onChange:le}},null,8,["label","modelValue","input-attr"]),e.fields[e.activateField].dataType?(s(),y(p,{key:0,label:r(t)("crud.crud.Field Type"),type:"textarea",modelValue:e.fields[e.activateField].dataType,"onUpdate:modelValue":l[18]||(l[18]=a=>e.fields[e.activateField].dataType=a)},null,8,["label","modelValue"])):(s(),b(V,{key:1},[n(p,{label:r(t)("crud.crud.Field Type"),type:"string",modelValue:e.fields[e.activateField].type,"onUpdate:modelValue":l[19]||(l[19]=a=>e.fields[e.activateField].type=a)},null,8,["label","modelValue"]),f("div",Nl,[n(p,{label:r(t)("crud.crud.length"),type:"number",modelValue:e.fields[e.activateField].length,"onUpdate:modelValue":l[20]||(l[20]=a=>e.fields[e.activateField].length=a),modelModifiers:{number:!0}},null,8,["label","modelValue"]),n(p,{label:r(t)("crud.crud.decimal point"),type:"number",modelValue:e.fields[e.activateField].precision,"onUpdate:modelValue":l[21]||(l[21]=a=>e.fields[e.activateField].precision=a),modelModifiers:{number:!0}},null,8,["label","modelValue"])])],64)),n(p,{label:r(t)("crud.crud.Field Defaults"),placeholder:r(t)("crud.crud.You can directly enter null, 0, empty string"),type:"string",modelValue:e.fields[e.activateField].default,"onUpdate:modelValue":l[22]||(l[22]=a=>e.fields[e.activateField].default=a)},null,8,["label","placeholder","modelValue"]),f("div",Rl,[n(p,{class:"form-item-position-right",label:r(t)("crud.state.Primary key"),type:"switch",modelValue:e.fields[e.activateField].primaryKey,"onUpdate:modelValue":l[23]||(l[23]=a=>e.fields[e.activateField].primaryKey=a)},null,8,["label","modelValue"]),n(p,{class:"form-item-position-right",label:r(t)("crud.crud.Auto increment"),type:"switch",modelValue:e.fields[e.activateField].autoIncrement,"onUpdate:modelValue":l[24]||(l[24]=a=>e.fields[e.activateField].autoIncrement=a)},null,8,["label","modelValue"])]),f("div",Al,[n(p,{class:"form-item-position-right",label:r(t)("crud.crud.Unsigned"),type:"switch",modelValue:e.fields[e.activateField].unsigned,"onUpdate:modelValue":l[25]||(l[25]=a=>e.fields[e.activateField].unsigned=a)},null,8,["label","modelValue"]),n(p,{class:"form-item-position-right",label:r(t)("crud.crud.Allow NULL"),type:"switch",modelValue:e.fields[e.activateField].null,"onUpdate:modelValue":l[26]||(l[26]=a=>e.fields[e.activateField].null=a)},null,8,["label","modelValue"])]),r($)(e.fields[e.activateField].table)?U("",!0):(s(),b(V,{key:2},[n(O,{"content-position":"left"},{default:u(()=>[C(h(r(t)("crud.crud.Field Table Properties")),1)]),_:1}),(s(!0),b(V,null,k(e.fields[e.activateField].table,(a,c)=>(s(),y(p,{key:c,label:o.$t("crud.crud."+c),type:a.type,modelValue:e.fields[e.activateField].table[c].value,"onUpdate:modelValue":_=>e.fields[e.activateField].table[c].value=_,placeholder:e.fields[e.activateField].table[c].placeholder??"",data:{content:e.fields[e.activateField].table[c].options??{}},"input-attr":e.fields[e.activateField].table[c].attr??{}},null,8,["label","type","modelValue","onUpdate:modelValue","placeholder","data","input-attr"]))),128))],64)),r($)(e.fields[e.activateField].form)?U("",!0):(s(),b(V,{key:3},[n(O,{"content-position":"left"},{default:u(()=>[C(h(r(t)("crud.crud.Field Form Properties")),1)]),_:1}),(s(!0),b(V,null,k(e.fields[e.activateField].form,(a,c)=>(s(),y(p,{key:c,label:o.$t("crud.crud."+c),type:a.type,modelValue:e.fields[e.activateField].form[c].value,"onUpdate:modelValue":_=>e.fields[e.activateField].form[c].value=_,placeholder:e.fields[e.activateField].form[c].placeholder??"",data:{content:e.fields[e.activateField].form[c].options??{}},"input-attr":e.fields[e.activateField].form[c].attr??{}},null,8,["label","type","modelValue","onUpdate:modelValue","placeholder","data","input-attr"]))),128))],64))]),_:1})]))])]),_:1})]),_:1})),[[W,e.loading.init]]),n(se,{onClose:de,class:"ba-operate-dialog","model-value":e.remoteSelectPre.show,title:r(t)("crud.crud.Remote drop-down association information"),"close-on-click-modal":!1,onKeyup:Ke(ie,["enter"])},{footer:u(()=>[f("div",{style:ye("width: calc(100% - 88px)")},[n(i,{onClick:de},{default:u(()=>[C(h(o.$t("Cancel")),1)]),_:1}),L((s(),y(i,{onClick:ie,type:"primary"},{default:u(()=>[C(h(o.$t("Save")),1)]),_:1})),[[x]])],4)]),default:u(()=>[f("div",{class:"ba-operate-form",style:ye("width: calc(100% - 80px)")},[L((s(),y(ne,{ref_key:"formRef",ref:N,model:e.remoteSelectPre.form,rules:xe,"label-position":"right","label-width":"160px","destroy-on-close":!0},{default:u(()=>[(s(),y(p,{prop:"table",type:"select",label:r(t)("crud.crud.Associated Data Table"),modelValue:e.remoteSelectPre.form.table,"onUpdate:modelValue":l[27]||(l[27]=a=>e.remoteSelectPre.form.table=a),key:JSON.stringify(e.remoteSelectPre.dbList),data:{content:e.remoteSelectPre.dbList},"input-attr":{onChange:Ie}},null,8,["label","modelValue","data","input-attr"])),L((s(),b("div",null,[(s(),y(p,{prop:"pk",type:"select",label:r(t)("crud.crud.Drop down value field"),modelValue:e.remoteSelectPre.form.pk,"onUpdate:modelValue":l[28]||(l[28]=a=>e.remoteSelectPre.form.pk=a),placeholder:r(t)("crud.crud.Please select the value field of the select component"),key:"select-value"+JSON.stringify(e.remoteSelectPre.fieldList),data:{content:e.remoteSelectPre.fieldList}},null,8,["label","modelValue","placeholder","data"])),(s(),y(p,{prop:"label",type:"select",label:r(t)("crud.crud.Drop down label field"),modelValue:e.remoteSelectPre.form.label,"onUpdate:modelValue":l[29]||(l[29]=a=>e.remoteSelectPre.form.label=a),placeholder:r(t)("crud.crud.Please select the label field of the select component"),key:"select-label"+JSON.stringify(e.remoteSelectPre.fieldList),data:{content:e.remoteSelectPre.fieldList}},null,8,["label","modelValue","placeholder","data"])),(s(),y(p,{prop:"joinField",type:"selects",label:r(t)("crud.crud.Fields displayed in the table"),modelValue:e.remoteSelectPre.form.joinField,"onUpdate:modelValue":l[30]||(l[30]=a=>e.remoteSelectPre.form.joinField=a),placeholder:r(t)("crud.crud.Please select the fields displayed in the table"),key:"join-field"+JSON.stringify(e.remoteSelectPre.fieldList),data:{content:e.remoteSelectPre.fieldList}},null,8,["label","modelValue","placeholder","data"])),(s(),y(p,{prop:"controllerFile",type:"select",label:r(t)("crud.crud.Controller position"),modelValue:e.remoteSelectPre.form.controllerFile,"onUpdate:modelValue":l[31]||(l[31]=a=>e.remoteSelectPre.form.controllerFile=a),placeholder:r(t)("crud.crud.Please select the controller of the data table"),key:"controller-file"+JSON.stringify(e.remoteSelectPre.controllerFileList),data:{content:e.remoteSelectPre.controllerFileList},attr:{"block-help":r(t)("crud.crud.The remote pull-down will request the corresponding controller to obtain data, so it is recommended that you create the CRUD of the associated table")}},null,8,["label","modelValue","placeholder","data","attr"])),(s(),y(p,{type:"select",label:r(t)("crud.crud.Data Model Location"),modelValue:e.remoteSelectPre.form.modelFile,"onUpdate:modelValue":l[32]||(l[32]=a=>e.remoteSelectPre.form.modelFile=a),placeholder:r(t)("crud.crud.Please select the data model location of the data table"),key:"model-file"+JSON.stringify(e.remoteSelectPre.modelFileList),data:{content:e.remoteSelectPre.modelFileList},attr:{"block-help":r(t)("crud.crud.If it is left blank, the model of the associated table will be generated automatically If the table already has a model, it is recommended to select it to avoid repeated generation")}},null,8,["label","modelValue","placeholder","data","attr"]))])),[[W,e.loading.remoteSelect]])]),_:1},8,["model","rules"])),[[W,e.remoteSelectPre.loading]])],4)]),_:1},8,["model-value","title","onKeyup"]),n(se,{onClose:z,class:"ba-operate-dialog confirm-generate-dialog","model-value":e.confirmGenerate.show,title:r(t)("crud.crud.Confirm CRUD code generation")},{footer:u(()=>[f("div",Gl,[n(i,{onClick:z},{default:u(()=>[C(h(o.$t("Cancel")),1)]),_:1}),L((s(),y(i,{loading:e.loading.generate,onClick:oe,type:"primary"},{default:u(()=>[C(h(r(t)("crud.crud.Continue building")),1)]),_:1},8,["loading"])),[[x]])])]),default:u(()=>[f("div",Kl,[e.confirmGenerate.controller?(s(),y(ce,{key:0,title:r(t)("crud.crud.The controller already exists Continuing to generate will automatically overwrite the existing code!"),center:"",type:"error"},null,8,["title"])):U("",!0),$l,e.confirmGenerate.table?(s(),y(ce,{key:1,title:r(t)("crud.crud.The data table already exists Continuing to generate will automatically delete the original table and create a new one!"),center:"",type:"error"},null,8,["title"])):U("",!0)])]),_:1},8,["model-value","title"])])}}});const lt=Xe(Bl,[["__scopeId","data-v-9df8a32c"]]);export{lt as default};
