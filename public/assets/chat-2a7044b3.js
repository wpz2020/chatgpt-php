import{d as D,H as y,q as H,s as b,o as S,w as z,f as r,c as n,a as l,b as A,g as a,j as e,F as B,J as E,x as _,K as N,e as C,i as k,z as j,A as $,L as h,_ as q}from"./index-9250cf41.js";import{a as J}from"./chat-5c60e301.js";import{u as K,c as x}from"./chat-0b571d6e.js";import{t as w}from"./timeToDate-4f013b84.js";import{s as O}from"./sendMsg-506581c3.js";import{x as T}from"./chat-b08578f0.js";import"./chat-608f0192.js";const P={class:"chat-content-body"},U={key:0},G=["index"],Q={key:0,class:"chat_left"},W={class:"user-avatr"},X={class:"user-avatr-time"},Y={class:"chat-speak"},Z={class:"chat-speak-01"},ee={class:"dh_action"},se={key:1,class:"chat_right"},te={class:"user-avatr"},ae={class:"user-avatr-time"},oe={class:"chat-speak"},ce=D({__name:"chat",setup(le){const u="preview-only",m=y(),p=y();let I=H(),V=K();const{chatMsgList:i,nowChatId:d}=b(V),{avatar:M}=b(I);function v(){let t=m.value.clientHeight;p.value.setScrollTop(t+500)}S(()=>{v();let t=x.getAllChat();Object.keys(t).length==0&&x.addChat()});const f=t=>`${t}`;let R=t=>{navigator.clipboard.writeText(t).then(()=>{h.success("复制成功")}).catch(o=>{var s=document.createElement("textarea");s.value=t,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),h.success("复制成功")})},F=()=>{h.success("重新发送中");let o=i.value[d.value].msglist;for(let s=0;s<o.length;s++)if(o[o.length-s-1].role=="user"){O(o[o.length-s-1].msg,"refresh");break}};return z(i,(t,o)=>{setTimeout(()=>{v()},100)},{deep:!0}),(t,o)=>{const s=C("el-avatar"),g=C("Icon");return r(),n("div",P,[l(e(N),{ref_key:"scrollbarRef",ref:p,style:{overflow:"hidden"},class:"infinite-list chat-content-scroll",always:""},{default:A(()=>[a("div",{ref_key:"innerRef",ref:m},[e(i)[e(d)]?(r(),n("div",U,[(r(!0),n(B,null,E(e(i)[e(d)].msglist,(c,L)=>(r(),n("div",{index:L,class:"scrollbar-demo-item"},[c.role!="user"?(r(),n("div",Q,[a("div",W,[l(s,{src:e(J)},null,8,["src"]),a("span",X,k(e(w).setTime(c.time)),1)]),a("div",Y,[a("div",Z,[l(e(T),{previewTheme:"vuepress",formatCopiedText:f,editorId:u,modelValue:c.msg},null,8,["modelValue"]),j(a("div",ee,[l(g,{name:"el-icon-CopyDocument",onClick:re=>e(R)(c.msg),title:"复制",color:"#8595F4",size:"20"},null,8,["onClick"]),l(g,{name:"el-icon-Refresh",onClick:e(F),title:"重试",color:"#8595F4",size:"20"},null,8,["onClick"])],512),[[$,c.isfinish]])])])])):_("",!0),c.role=="user"?(r(),n("div",se,[a("div",te,[l(s,{src:e(M)},null,8,["src"]),a("span",ae,k(e(w).setTime(c.time)),1)]),a("div",oe,[l(e(T),{previewTheme:"vuepress",formatCopiedText:f,editorId:u,modelValue:c.msg},null,8,["modelValue"])])])):_("",!0)],8,G))),256))])):_("",!0)],512)]),_:1},512)])}}});const pe=q(ce,[["__scopeId","data-v-74bae1bb"]]);export{pe as default};
