var Q=Object.defineProperty;var X=(a,i,m)=>i in a?Q(a,i,{enumerable:!0,configurable:!0,writable:!0,value:m}):a[i]=m;var f=(a,i,m)=>(X(a,typeof i!="symbol"?i+"":i,m),m);import{defineComponent as Y,reactive as I,ref as b,onMounted as Z,nextTick as ee,onBeforeUnmount as te,resolveComponent as c,openBlock as v,createElementBlock as L,createElementVNode as r,createVNode as o,withCtx as s,Fragment as oe,renderList as ae,unref as p,createBlock as M,createTextVNode as q,toDisplayString as S,withModifiers as ne,withKeys as se,createCommentVNode as le,pushScopeId as ie,popScopeId as ce}from"vue";import{ElNotification as re}from"element-plus";import{useI18n as de}from"vue-i18n";import{d as ue,h as pe,i as B,j as me,k as he,r as fe,_ as _e}from"./index-89e26330.js";import{l as T}from"./index-afb9c73e.js";import{b as g}from"./validate-e09b6b50.js";import"vue-router";import"pinia";import"vue-demi";const ge="/assets/login-header-2b702f97.png",we="/assets/avatar-a1b16617.png",e={width:0,height:0,bubbleEl:null,canvas:null,ctx:{},circles:[],animate:!0,requestId:null},be=function(){e.width=window.innerWidth,e.height=window.innerHeight,e.bubbleEl=document.getElementById("bubble"),e.bubbleEl.style.height=e.height+"px",e.canvas=document.getElementById("bubble-canvas"),e.canvas.width=e.width,e.canvas.height=e.height,e.ctx=e.canvas.getContext("2d"),e.circles=[];for(let a=0;a<e.width*.5;a++){const i=new ve;e.circles.push(i)}A(),xe()};function U(){e.animate=!(document.body.scrollTop>e.height)}function N(){e.width=window.innerWidth,e.height=window.innerHeight,e.bubbleEl.style.height=e.height+"px",e.canvas.width=e.width,e.canvas.height=e.height}function A(){if(e.animate){e.ctx.clearRect(0,0,e.width,e.height);for(const a in e.circles)e.circles[a].draw()}e.requestId=requestAnimationFrame(A)}class ve{constructor(){f(this,"pos");f(this,"alpha");f(this,"scale");f(this,"velocity");f(this,"draw");this.pos={x:Math.random()*e.width,y:e.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random(),this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,e.ctx.beginPath(),e.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),e.ctx.fillStyle="rgba(255,255,255,"+this.alpha+")",e.ctx.fill()}}}function xe(){window.addEventListener("scroll",U),window.addEventListener("resize",N)}function ye(){window.removeEventListener("scroll",U),window.removeEventListener("resize",N),cancelAnimationFrame(e.requestId)}const C=a=>(ie("data-v-51f07815"),a=a(),ce(),a),ke={class:"switch-language"},Ie=C(()=>r("canvas",{id:"bubble-canvas",class:"bubble-canvas"},null,-1)),Ce=[Ie],Ve={class:"login"},Ee={class:"login-box"},ze=C(()=>r("div",{class:"head"},[r("img",{src:ge,alt:""})],-1)),Pe={class:"form"},Re=C(()=>r("img",{class:"profile-avatar",src:we,alt:""},null,-1)),Le={class:"content"},Me=["src"],qe=Y({__name:"login",setup(a){var i;const m=ue(),F=pe(),_=I({showCaptcha:!1,captchaId:B()}),x=()=>{t.captcha="",_.captchaId=B()},y=b(),V=b(),E=b(),z=b(),t=I({username:"",password:"",captcha:"",keep:!1,loading:!1,captcha_id:""}),{t:d}=de(),$=I({username:[g({name:"required",message:d("login.Please enter an account")}),g({name:"account"})],password:[g({name:"required",message:d("login.Please input a password")}),g({name:"password"})],captcha:[g({name:"required",title:d("login.Please enter the verification code")}),{min:4,max:6,message:d("login.The verification code length must be between 4 and 6 bits"),trigger:"blur"}]}),D=()=>{t.username===""?V.value.focus():t.password===""?E.value.focus():t.captcha===""&&z.value.focus()};Z(()=>{i=setTimeout(()=>{be()},1e3),T("get").then(h=>{_.showCaptcha=h.data.captcha,ee(()=>{D()})}).catch(h=>{console.log(h)})}),te(()=>{clearTimeout(i),ye()});const P=h=>{h&&h.validate(n=>{if(n)t.loading=!0,t.captcha_id=_.captchaId,T("post",t).then(u=>{t.loading=!1,F.dataFill(u.data.userInfo),re({message:u.msg,type:"success"}),fe.push({path:u.data.routePath})}).catch(()=>{x(),t.loading=!1});else return x(),!1})};return(h,n)=>{const u=c("Icon"),H=c("el-dropdown-item"),K=c("el-dropdown-menu"),W=c("el-dropdown"),k=c("el-input"),w=c("el-form-item"),R=c("el-col"),j=c("el-row"),G=c("el-checkbox"),J=c("el-button"),O=c("el-form");return v(),L("div",null,[r("div",ke,[o(W,{size:"large","hide-timeout":50,placement:"bottom-end","hide-on-click":!0},{dropdown:s(()=>[o(K,{class:"chang-lang"},{default:s(()=>[(v(!0),L(oe,null,ae(p(m).lang.langArray,l=>(v(),M(H,{key:l.name,onClick:Se=>p(me)(l.name)},{default:s(()=>[q(S(l.value),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:s(()=>[o(u,{name:"fa fa-globe",color:"var(--el-text-color-secondary)",size:"28"})]),_:1})]),r("div",{onContextmenu:n[0]||(n[0]=ne(()=>{},["stop"])),id:"bubble",class:"bubble"},Ce,32),r("div",Ve,[r("div",Ee,[ze,r("div",Pe,[Re,r("div",Le,[o(O,{onKeyup:n[6]||(n[6]=se(l=>P(y.value),["enter"])),ref_key:"formRef",ref:y,rules:$,size:"large",model:t},{default:s(()=>[o(w,{prop:"username"},{default:s(()=>[o(k,{ref_key:"usernameRef",ref:V,type:"text",clearable:"",modelValue:t.username,"onUpdate:modelValue":n[1]||(n[1]=l=>t.username=l),placeholder:p(d)("login.Please enter an account")},{prefix:s(()=>[o(u,{name:"fa fa-user",class:"form-item-icon",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),o(w,{prop:"password"},{default:s(()=>[o(k,{ref_key:"passwordRef",ref:E,modelValue:t.password,"onUpdate:modelValue":n[2]||(n[2]=l=>t.password=l),type:"password",placeholder:p(d)("login.Please input a password"),"show-password":""},{prefix:s(()=>[o(u,{name:"fa fa-unlock-alt",class:"form-item-icon",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),_.showCaptcha?(v(),M(w,{key:0,prop:"captcha"},{default:s(()=>[o(j,{class:"w100",gutter:15},{default:s(()=>[o(R,{span:16},{default:s(()=>[o(k,{ref_key:"captchaRef",ref:z,type:"text",placeholder:p(d)("login.Please enter the verification code"),modelValue:t.captcha,"onUpdate:modelValue":n[3]||(n[3]=l=>t.captcha=l),clearable:"",autocomplete:"off"},{prefix:s(()=>[o(u,{name:"fa fa-ellipsis-h",class:"form-item-icon",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["placeholder","modelValue"])]),_:1}),o(R,{span:8},{default:s(()=>[r("img",{onClick:x,class:"captcha-img",src:p(he)()+"&id="+_.captchaId,alt:""},null,8,Me)]),_:1})]),_:1})]),_:1})):le("",!0),o(G,{modelValue:t.keep,"onUpdate:modelValue":n[4]||(n[4]=l=>t.keep=l),label:p(d)("login.Hold session"),size:"default"},null,8,["modelValue","label"]),o(w,null,{default:s(()=>[o(J,{loading:t.loading,class:"submit-button",round:"",type:"primary",size:"large",onClick:n[5]||(n[5]=l=>P(y.value))},{default:s(()=>[q(S(p(d)("login.Sign in")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","model"])])])])])])}}});const We=_e(qe,[["__scopeId","data-v-51f07815"]]);export{We as default};
