import{defineComponent as G,ref as U,reactive as V,onMounted as J,onUnmounted as O,resolveComponent as d,openBlock as u,createElementBlock as k,createVNode as t,withCtx as l,unref as r,createElementVNode as P,toDisplayString as b,withKeys as Q,createBlock as f,createCommentVNode as h,createTextVNode as w}from"vue";import{H as X}from"./header-55e7bca2.js";import{F as Y}from"./footer-c2b5a3bf.js";import{b as Z,u as ee,i as q,n as oe,o as R,k as te,w as ae,x as le,_ as re}from"./index-89e26330.js";import{u as ne}from"./memberCenter-893be883.js";import{useI18n as ie}from"vue-i18n";import{b as m,v as se}from"./validate-e09b6b50.js";import{useRoute as de,useRouter as me}from"vue-router";import{l as ue,L as ce}from"./loginFooter-088178d1.js";import"./logo-dbed91f4.js";import"pinia";import"./menu-c85258cb.js";import"vue-demi";import"element-plus";const pe={class:"login chat-login"},fe={key:0,class:"login-box"},ge={class:"login-title"},_e=["src"],be={key:4,class:"form-footer"},he=G({__name:"login copy",setup(ye){let x;const{t:a}=ie(),F=de(),$=me(),E=Z(),z=ee(),M=ne(),g=U();U();const e=V({form:{tab:"login",email:"",mobile:"",username:"",password:"",captcha:"",keep:!1,captchaId:q(),registerType:"email"},formLoading:!1,showCaptcha:!1,showRetrievePasswordDialog:!1,retrievePasswordForm:{type:"email",account:"",captcha:"",password:""},dialogWidth:36,accountVerificationType:[],codeSendCountdown:0,submitRetrieveLoading:!1,sendCaptchaLoading:!1}),N=V({email:[m({name:"required",title:a("user.login.email")}),m({name:"email",title:a("user.login.email")})],username:[m({name:"required",title:a("user.login.User name")}),{validator:(n,o,s)=>{if(e.form.tab=="register")return se(n,o,s);s()},trigger:"blur"}],password:[m({name:"required",title:a("user.login.password")}),m({name:"password"})],mobile:[m({name:"required",title:a("user.login.mobile")}),m({name:"mobile"})]});V({account:[m({name:"required",title:a("user.login.Account name")})],captcha:[m({name:"required",title:a("user.login.Verification Code")})],password:[m({name:"required",title:a("user.login.password")}),m({name:"password"})]});const T=()=>{let n=document.documentElement.clientWidth,o=36;n<=790?o=92:n<=910?o=56:n<=1260&&(o=46),e.dialogWidth=o},v=()=>{e.form.captcha="",e.form.captchaId=q()},S=(n=void 0)=>{n.validate(o=>{o?(e.formLoading=!0,R("post",e.form).then(s=>{e.formLoading=!1,E.dataFill(s.data.userInfo),$.push({path:s.data.routePath})}).catch(()=>{e.formLoading=!1,v()})):v()})},B=(n=void 0)=>{e.codeSendCountdown>0||n.validateField([e.form.registerType,"username","password"]).then(o=>{o&&(e.sendCaptchaLoading=!0,(e.form.registerType=="email"?ae:le)(e.form[e.form.registerType],"user_register").then(c=>{c.code==1&&W(60)}).finally(()=>{e.sendCaptchaLoading=!1}))})},I=(n=void 0,o)=>{e.form.tab=o,o=="register"&&(e.form.username=""),n&&n.clearValidate()},W=n=>{e.codeSendCountdown=n,x=setInterval(()=>{e.codeSendCountdown--,e.codeSendCountdown<=0&&L()},1e3)},L=()=>{e.codeSendCountdown=0,clearInterval(x)};return J(async()=>{await ue()||(T(),oe(window,"resize",T),R("get").then(n=>{e.accountVerificationType=n.data.accountVerificationType,e.retrievePasswordForm.type=n.data.accountVerificationType.length>0?n.data.accountVerificationType[0]:""}),F.query.type=="register"&&(e.form.tab="register"))}),O(()=>{e.codeSendCountdown=0,L()}),(n,o)=>{const s=d("Icon"),c=d("el-input"),p=d("el-form-item"),_=d("el-col"),C=d("el-row"),y=d("el-button"),D=d("el-checkbox"),A=d("el-form"),H=d("el-alert"),K=d("el-main"),j=d("el-container");return u(),k("div",pe,[t(j,{class:"is-vertical"},{default:l(()=>[t(X),t(K,{class:"frontend-footer-brother"},{default:l(()=>[t(C,{justify:"center"},{default:l(()=>[t(_,{span:16,xs:24},{default:l(()=>[r(M).state.open?(u(),k("div",fe,[P("div",ge," 欢迎"+b(r(a)("user.login."+e.form.tab)),1),t(A,{ref_key:"formRef",ref:g,onKeyup:o[11]||(o[11]=Q(i=>S(g.value),["enter"])),rules:N,model:e.form},{default:l(()=>[t(p,{prop:"username"},{default:l(()=>[t(c,{modelValue:e.form.username,"onUpdate:modelValue":o[0]||(o[0]=i=>e.form.username=i),placeholder:e.form.tab=="register"?r(a)("Please input field",{field:r(a)("user.login.User name")}):r(a)("Please input field",{field:r(a)("user.login.account")}),clearable:!0,size:"large"},{prefix:l(()=>[t(s,{name:"fa fa-user",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),t(p,{prop:"password"},{default:l(()=>[t(c,{modelValue:e.form.password,"onUpdate:modelValue":o[1]||(o[1]=i=>e.form.password=i),placeholder:r(a)("Please input field",{field:r(a)("user.login.password")}),type:"password","show-password":"",size:"large"},{prefix:l(()=>[t(s,{name:"fa fa-unlock-alt",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),e.form.tab=="login"&&r(z).loginCheck=="true"?(u(),f(p,{key:0,prop:"captcha"},{default:l(()=>[t(C,{class:"w100"},{default:l(()=>[t(_,{span:16},{default:l(()=>[t(c,{modelValue:e.form.captcha,"onUpdate:modelValue":o[2]||(o[2]=i=>e.form.captcha=i),clearable:"",autocomplete:"off",placeholder:r(a)("Please input field",{field:r(a)("user.login.Verification Code")}),size:"large"},{prefix:l(()=>[t(s,{name:"fa fa-ellipsis-h",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),t(_,{class:"captcha-box",span:8},{default:l(()=>[P("img",{onClick:v,class:"captcha-img",src:r(te)()+"&id="+e.form.captchaId,alt:""},null,8,_e)]),_:1})]),_:1})]),_:1})):h("",!0),e.form.tab=="register"&&e.form.registerType=="mobile"?(u(),f(p,{key:1,prop:"mobile"},{default:l(()=>[t(c,{modelValue:e.form.mobile,"onUpdate:modelValue":o[3]||(o[3]=i=>e.form.mobile=i),placeholder:r(a)("Please input field",{field:r(a)("user.login.mobile")}),clearable:!0,size:"large"},{prefix:l(()=>[t(s,{name:"fa fa-tablet",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1})):h("",!0),e.form.tab=="register"&&e.form.registerType=="email"?(u(),f(p,{key:2,prop:"email"},{default:l(()=>[t(c,{modelValue:e.form.email,"onUpdate:modelValue":o[4]||(o[4]=i=>e.form.email=i),placeholder:r(a)("Please input field",{field:r(a)("user.login.email")}),clearable:!0,size:"large"},{prefix:l(()=>[t(s,{name:"fa fa-envelope",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1})):h("",!0),e.form.tab=="register"&&r(z).openCheck=="true"?(u(),f(p,{key:3,prop:"captcha"},{default:l(()=>[t(C,{class:"w100"},{default:l(()=>[t(_,{span:16},{default:l(()=>[t(c,{size:"large",modelValue:e.form.captcha,"onUpdate:modelValue":o[5]||(o[5]=i=>e.form.captcha=i),placeholder:r(a)("Please input field",{field:r(a)("user.login.Verification Code")}),autocomplete:"off"},{prefix:l(()=>[t(s,{name:"fa fa-ellipsis-h",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),t(_,{class:"captcha-box",span:8},{default:l(()=>[t(y,{size:"large",onClick:o[6]||(o[6]=i=>B(g.value)),loading:e.sendCaptchaLoading,disabled:!(e.codeSendCountdown<=0),type:"primary"},{default:l(()=>[w(b(e.codeSendCountdown<=0?r(a)("user.login.send"):e.codeSendCountdown+r(a)("user.login.seconds")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})):h("",!0),e.form.tab!="register"?(u(),k("div",be,[t(D,{modelValue:e.form.keep,"onUpdate:modelValue":o[7]||(o[7]=i=>e.form.keep=i),label:r(a)("user.login.Remember me"),size:"default"},null,8,["modelValue","label"])])):h("",!0),t(p,{class:"form-buttons"},{default:l(()=>[t(y,{class:"login-btn",onClick:o[8]||(o[8]=i=>S(g.value)),loading:e.formLoading,round:"",type:"primary",size:"large"},{default:l(()=>[w(b(r(a)("user.login."+e.form.tab)),1)]),_:1},8,["loading"]),e.form.tab=="register"?(u(),f(y,{key:0,onClick:o[9]||(o[9]=i=>I(g.value,"login")),round:"",plain:"",type:"info",size:"large"},{default:l(()=>[w(b(r(a)("user.login.Back to login")),1)]),_:1})):(u(),f(y,{key:1,onClick:o[10]||(o[10]=i=>I(g.value,"register")),round:"",plain:"",type:"info",size:"large"},{default:l(()=>[w(b(r(a)("user.login.No account yet? Click Register")),1)]),_:1}))]),_:1}),t(ce)]),_:1},8,["rules","model"])])):(u(),f(H,{key:1,center:!0,title:n.$t("Member center disabled"),type:"error"},null,8,["title"]))]),_:1})]),_:1})]),_:1}),t(Y)]),_:1})])}}});const Re=re(he,[["__scopeId","data-v-c0d3cc3a"]]);export{Re as default};
