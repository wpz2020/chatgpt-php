import{defineComponent as F,reactive as S,watchEffect as T,onMounted as $,ref as b,toRefs as h,resolveComponent as n,openBlock as _,createBlock as y,withCtx as r,createElementVNode as A,createVNode as t,createTextVNode as s,unref as o,withDirectives as D,createElementBlock as G,Fragment as I,renderList as L,vShow as M}from"vue";import{c as x,m as c,_ as P}from"./index-89e26330.js";import"vue-i18n";import"vue-router";import"pinia";import"vue-demi";import"element-plus";const R={class:"dialog-footer"},j=F({__name:"pladd",emits:["init"],setup(q,{expose:g,emit:w}){let d=S({sform:{type:"custom",product_id:0,addnum:0,day:0,num:0},product:[]});T(()=>{d.sform.type=="vip"&&d.sform.product_id!=0&&d.product.forEach(u=>{u.id==d.sform.product_id&&(d.sform.day=u.expire,d.sform.num=u.num)})}),$(()=>{x({url:"/admin/product/index",method:"GET",params:{}}).then(e=>{e.code==1&&(d.product=e.data.list)})});let i=b(!1);const p=b(i);g({isshow:i});let k=async()=>{if(d.sform.addnum<=0||d.sform.day<=0||d.sform.num<=0)return c.error("表单填写不正确,请检查"),!1;if(d.sform.type=="vip"&&d.sform.product_id==0)return c.error("产品套餐需要选择"),!1;(await x({url:"/admin/carmi/pladd",method:"post",data:d.sform})).code==1&&(c.success("添加成功"),w("init"),i.value=!1)},{sform:a,product:U}=h(d);return(u,e)=>{const v=n("el-radio"),C=n("el-radio-group"),m=n("el-form-item"),E=n("el-option"),z=n("el-select"),f=n("el-input"),B=n("el-form"),V=n("el-button"),N=n("el-dialog");return _(),y(N,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=l=>p.value=l),title:"批量添加卡密",width:"50%"},{footer:r(()=>[A("span",R,[t(V,{onClick:e[5]||(e[5]=l=>p.value=!1)},{default:r(()=>[s("取消")]),_:1}),t(V,{type:"primary",onClick:e[6]||(e[6]=l=>o(k)())},{default:r(()=>[s(" 确定 ")]),_:1})])]),default:r(()=>[t(B,{model:o(a),"label-width":"120px"},{default:r(()=>[t(m,{label:"卡密类型"},{default:r(()=>[t(C,{modelValue:o(a).type,"onUpdate:modelValue":e[0]||(e[0]=l=>o(a).type=l),class:"ml-4"},{default:r(()=>[t(v,{label:"custom",size:""},{default:r(()=>[s("普通卡密")]),_:1}),t(v,{label:"vip",size:""},{default:r(()=>[s("套餐卡密")]),_:1})]),_:1},8,["modelValue"])]),_:1}),D(t(m,{label:"产品套餐"},{default:r(()=>[t(z,{modelValue:o(a).product_id,"onUpdate:modelValue":e[1]||(e[1]=l=>o(a).product_id=l),class:"m-2",placeholder:"Select",size:""},{default:r(()=>[(_(!0),G(I,null,L(o(U),l=>(_(),y(E,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},512),[[M,o(a).type=="vip"]]),t(m,{label:"生成卡密数量"},{default:r(()=>[t(f,{modelValue:o(a).addnum,"onUpdate:modelValue":e[2]||(e[2]=l=>o(a).addnum=l),placeholder:"请输入数量"},null,8,["modelValue"])]),_:1}),t(m,{label:"有效天数"},{default:r(()=>[t(f,{disabled:o(a).type=="vip",modelValue:o(a).day,"onUpdate:modelValue":e[3]||(e[3]=l=>o(a).day=l),placeholder:"请输入有效天数"},null,8,["disabled","modelValue"])]),_:1}),t(m,{label:"可用聊天次数"},{default:r(()=>[t(f,{disabled:o(a).type=="vip",modelValue:o(a).num,"onUpdate:modelValue":e[4]||(e[4]=l=>o(a).num=l),placeholder:"请输入聊天次数"},null,8,["disabled","modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});const Y=P(j,[["__scopeId","data-v-d9b9c3a2"]]);export{Y as default};
